{"version":3,"sources":["yysdk.js"],"names":["GetQueryString","name","reg","RegExp","r","window","location","search","substr","match","decodeURIComponent","GetWsUrl","wsdomain","port","sign","nonstr","timestamp","post_data","obj","JSON","parse","gameid","roomid","ws_url","GetWssUrl","JYXGetGameData","data","decodeURI","JYXStartGame","nativeApp","onPKLoading","JYXFinishLoading","onPKFinishLoading","JYXLoadFail","onPKLoadFail","JYXPKStart","onPKStart","JYXPKFinish","result","onPKFinish","TZOpen","getResult","e","JYXInfo","str","logInfo","JYXError","logError","YYSDK","getSignData","getGameData","userdata","getRoomId","getPlayer","player","exports"],"mappings":";;;;;;AAAA,SAASA,cAAT,CAAwBC,IAAxB,EAA8B;AAC1B,QAAIC,MAAM,IAAIC,MAAJ,CAAW,UAAUF,IAAV,GAAiB,eAA5B,CAAV;AACA,QAAIG,IAAIC,OAAOC,QAAP,CAAgBC,MAAhB,CAAuBC,MAAvB,CAA8B,CAA9B,EAAiCC,KAAjC,CAAuCP,GAAvC,CAAR;AACA,QAAIE,KAAK,IAAT,EACI,OAAOM,mBAAmBN,EAAE,CAAF,CAAnB,CAAP;AACJ,WAAO,IAAP;AACH;;AAED,SAASO,QAAT,GAAoB;AAChB,QAAIC,WAAWZ,eAAe,iBAAf,CAAf;AACA,QAAIY,aAAa,IAAjB,EAAuB;AACnB,eAAO,IAAP;AACH;AACD,QAAIC,OAAOb,eAAe,MAAf,CAAX;AACA,QAAIc,OAAOd,eAAe,MAAf,CAAX;AACA,QAAIe,SAASf,eAAe,QAAf,CAAb;AACA,QAAIgB,YAAYhB,eAAe,WAAf,CAAhB;AACA,QAAIiB,YAAYjB,eAAe,WAAf,CAAhB;;AAEA,QAAIkB,MAAMC,KAAKC,KAAL,CAAWH,SAAX,CAAV;AACA,QAAII,SAASH,IAAIG,MAAjB;AACA,QAAIC,SAASJ,IAAII,MAAjB;;AAEA,QAAIC,SAAS,UAAUX,QAAV,GAAqB,GAArB,GAA2BC,IAA3B,GAAkC,GAAlC,GAAwCQ,MAAxC,GAAiD,GAAjD,GAAuDC,MAAvD,GACT,UADS,GACIP,MADJ,GACa,QADb,GACwBD,IADxB,GAET,aAFS,GAEOE,SAFP,GAEmB,aAFnB,GAEmCC,SAFhD;;AAIA,WAAOM,MAAP;AACH;;AAED,SAASC,SAAT,GAAqB;AACjB,QAAIZ,WAAWZ,eAAe,iBAAf,CAAf;AACA,QAAIY,aAAa,IAAjB,EAAuB;AACnB,eAAO,IAAP;AACH;AACD,QAAIC,OAAOb,eAAe,MAAf,CAAX;AACA,QAAIc,OAAOd,eAAe,MAAf,CAAX;AACA,QAAIe,SAASf,eAAe,QAAf,CAAb;AACA,QAAIgB,YAAYhB,eAAe,WAAf,CAAhB;AACA,QAAIiB,YAAYjB,eAAe,WAAf,CAAhB;;AAEA,QAAIkB,MAAMC,KAAKC,KAAL,CAAWH,SAAX,CAAV;AACA,QAAII,SAASH,IAAIG,MAAjB;AACA,QAAIC,SAASJ,IAAII,MAAjB;;AAEA,QAAIC,SAAS,WAAWX,QAAX,GAAsB,GAAtB,GAA4BC,IAA5B,GAAmC,GAAnC,GAAyCQ,MAAzC,GAAkD,GAAlD,GAAwDC,MAAxD,GACT,UADS,GACIP,MADJ,GACa,QADb,GACwBD,IADxB,GAET,aAFS,GAEOE,SAFP,GAEmB,aAFnB,GAEmCC,SAFhD;AAGA,WAAOM,MAAP;AACH;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,SAASE,cAAT,GAA0B;AACtB,QAAIC,OAAO1B,eAAe,WAAf,CAAX;AACA,WAAO2B,UAAUD,IAAV,CAAP;AACH;;AAED;AACA,SAASE,YAAT,GAAwB;AACpB,QAAIvB,OAAOwB,SAAP,IAAoB,IAApB,IAA4BxB,OAAOwB,SAAP,CAAiBC,WAAjB,IAAgC,IAAhE,EAAsE;AAClE;AACH;AACDzB,WAAOwB,SAAP,CAAiBC,WAAjB,CAA6B,IAA7B;AACH;;AAED;AACA,SAASC,gBAAT,GAA4B;AACxB,QAAI1B,OAAOwB,SAAP,IAAoB,IAApB,IAA4BxB,OAAOwB,SAAP,CAAiBG,iBAAjB,IAAsC,IAAtE,EAA4E;AACxE;AACH;AACD3B,WAAOwB,SAAP,CAAiBG,iBAAjB,CAAmC,IAAnC;AACH;;AAED;AACA,SAASC,WAAT,GAAuB;AACnB,QAAI5B,OAAOwB,SAAP,IAAoB,IAApB,IAA4BxB,OAAOwB,SAAP,CAAiBK,YAAjB,IAAiC,IAAjE,EAAuE;AACnE;AACH;AACD7B,WAAOwB,SAAP,CAAiBK,YAAjB,CAA8B,IAA9B;AACH;;AAED;AACA,SAASC,UAAT,GAAsB;AAClB,QAAI9B,OAAOwB,SAAP,IAAoB,IAApB,IAA4BxB,OAAOwB,SAAP,CAAiBO,SAAjB,IAA8B,IAA9D,EAAoE;AAChE;AACH;AACD/B,WAAOwB,SAAP,CAAiBO,SAAjB,CAA2B,IAA3B;AACH;;AAED;AACA,SAASC,WAAT,CAAqBC,MAArB,EAA6B;AACzB,QAAIjC,OAAOwB,SAAP,IAAoB,IAApB,IAA4BxB,OAAOwB,SAAP,CAAiBU,UAAjB,IAA+B,IAA/D,EAAqE;AACjElC,eAAOwB,SAAP,CAAiBU,UAAjB,CAA4BD,MAA5B;AACA;AACH;;AAED,QAAI;AACAE,eAAOC,SAAP,CAAiBH,MAAjB;AACH,KAFD,CAEE,OAAOI,CAAP,EAAU,CACX;AACJ;;AAED,SAASC,OAAT,CAAiBC,GAAjB,EAAsB;AAClB,QAAIvC,OAAOwB,SAAP,IAAoB,IAAxB,EAA8B;AAC1B;AACH;AACDxB,WAAOwB,SAAP,CAAiBgB,OAAjB,CAAyBD,GAAzB;AACH;;AAED,SAASE,QAAT,CAAkBF,GAAlB,EAAuB;AACnB,QAAIvC,OAAOwB,SAAP,IAAoB,IAAxB,EAA8B;AAC1B;AACH;AACDxB,WAAOwB,SAAP,CAAiBkB,QAAjB,CAA0BH,GAA1B;AACH;;AAED,IAAII,QAAQ;AACRrC,cAAUA,QADF;AAERa,eAAWA,SAFH;AAGRI,kBAAcA,YAHN;AAIRG,sBAAkBA,gBAJV;AAKRE,iBAAaA,WALL;AAMRE,gBAAYA,UANJ;AAORE,iBAAaA,WAPL;AAQRM,aAASA,OARD;AASRG,cAAUA,QATF;AAURG,iBAAa,uBAAY;AACrB,YAAIjC,YAAYhB,eAAe,WAAf,CAAhB;AACA,YAAIe,SAASf,eAAe,QAAf,CAAb;AACA,YAAIc,OAAOd,eAAe,MAAf,CAAX;AACA,YAAIiB,YAAYjB,eAAe,WAAf,CAAhB;AACA,YAAIgB,aAAaD,MAAb,IAAuBD,IAAvB,IAA+BG,SAAnC,EAA8C;AAC1C,mBAAO;AACHD,2BAAWA,SADR;AAEHD,wBAAQA,MAFL;AAGHD,sBAAMA,IAHH;AAIHG,2BAAWA;AAJR,aAAP;AAMH;AACD,eAAO,IAAP;AACH,KAxBO;AAyBRiC,iBAAa,uBAAY;AACrB,YAAIC,WAAW1B,gBAAf;AACA,YAAI0B,QAAJ,EAAc;AACV,gBAAI;AACAA,2BAAWhC,KAAKC,KAAL,CAAW+B,QAAX,CAAX;AACA,uBAAOA,QAAP;AACH,aAHD,CAGE,OAAOT,CAAP,EAAU;AACR,uBAAO,IAAP;AACH;AACJ;AACD,eAAO,IAAP;AACH,KApCO;AAqCRU,eAAW,qBAAY;AACnB,YAAID,WAAW,KAAKD,WAAL,EAAf;AACA,YAAIC,QAAJ,EAAc;AACV,mBAAOA,SAAS7B,MAAhB;AACH;AACD,eAAO,CAAP;AACH,KA3CO;AA4CR+B,eAAW,qBAAY;AACnB,YAAIF,WAAW,KAAKD,WAAL,EAAf;AACA,YAAIC,QAAJ,EAAc;AACV,mBAAOA,SAASG,MAAhB;AACH;AACD,eAAO,IAAP;AACH;AAlDO,CAAZ;AAoDAC,QAAQP,KAAR,GAAgBA,KAAhB","file":"yysdk.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\module","sourcesContent":["function GetQueryString(name) {\r\n    var reg = new RegExp(\"(^|&)\" + name + \"=([^&]*)(&|$)\");\r\n    var r = window.location.search.substr(1).match(reg);\r\n    if (r != null)\r\n        return decodeURIComponent(r[2]);\r\n    return null;\r\n}\r\n\r\nfunction GetWsUrl() {\r\n    var wsdomain = GetQueryString(\"websocketdomain\");\r\n    if (wsdomain === null) {\r\n        return null;\r\n    }\r\n    var port = GetQueryString(\"port\");\r\n    var sign = GetQueryString(\"sign\");\r\n    var nonstr = GetQueryString(\"nonstr\");\r\n    var timestamp = GetQueryString(\"timestamp\");\r\n    var post_data = GetQueryString(\"post_data\");\r\n\r\n    var obj = JSON.parse(post_data);\r\n    var gameid = obj.gameid;\r\n    var roomid = obj.roomid;\r\n\r\n    var ws_url = \"ws://\" + wsdomain + \":\" + port + \"/\" + gameid + \"/\" + roomid +\r\n        \"?nonstr=\" + nonstr + \"&sign=\" + sign +\r\n        \"&timestamp=\" + timestamp + \"&post_data=\" + post_data;\r\n\r\n    return ws_url;\r\n}\r\n\r\nfunction GetWssUrl() {\r\n    var wsdomain = GetQueryString(\"websocketdomain\");\r\n    if (wsdomain === null) {\r\n        return null;\r\n    }\r\n    var port = GetQueryString(\"port\");\r\n    var sign = GetQueryString(\"sign\");\r\n    var nonstr = GetQueryString(\"nonstr\");\r\n    var timestamp = GetQueryString(\"timestamp\");\r\n    var post_data = GetQueryString(\"post_data\");\r\n\r\n    var obj = JSON.parse(post_data);\r\n    var gameid = obj.gameid;\r\n    var roomid = obj.roomid;\r\n\r\n    var ws_url = \"wss://\" + wsdomain + \":\" + port + \"/\" + gameid + \"/\" + roomid +\r\n        \"?nonstr=\" + nonstr + \"&sign=\" + sign +\r\n        \"&timestamp=\" + timestamp + \"&post_data=\" + post_data;\r\n    return ws_url;\r\n}\r\n\r\n// http://域名/xxx?timestamp=XXX&nonstr=YYY&sign=3jiu7e9o>&post_data=url_encode(请求的jsonbody)\r\n// http://120.78.80.166/test/auth.php?nonstr=jg4g3b0i-7pb0-92y5-mu0ae997nmb6gg3p&\r\n// sign=c7961cc7357f8a991edf5a93daf1e69b2d7c30ab×tamp=1509710152&post_data=%7B%22channelid%22%3A%22guangzhou1%22%2C%22gameid%22%3A%22ninedead%22%2C%22roomid%22%3A%22568bc11c-504c-4be8-9104-0be6b0cc2375%22%2C%22player%22%3A%7B%22uid%22%3A%221830969817%22%2C%22name%22%3A%22mr.yipxx%22%2C%22avatarurl%22%3A%22http%3A%2F%2Fs1.yy.com%2Fguild%2Fheader%2F10001.jpg%22%2C%22teamid%22%3A%221%22%2C%22opt%22%3A%22%22%7D%7D&websocketdomain=xyxng1.yystatic.com&port=10500\r\n// {\r\n//     \"channelid\":\"guangzhou1\",\r\n//     \"gameid\":\"ninedead\",\r\n//     \"roomid\":\"568bc11c-504c-4be8-9104-0be6b0cc2375\",\r\n//     \"player\":{\r\n//         \"uid\":\"1830969817\",\r\n//         \"name\":\"mr.yipxx\",\r\n//         \"avatarurl\":\"http://s1.yy.com/guild/header/10001.jpg\",\r\n//         \"teamid\":\"1\",\r\n//         \"opt\":\"\"\r\n//     }\r\n// }\r\n\r\n// 获取玩家数据\r\nfunction JYXGetGameData() {\r\n    var data = GetQueryString(\"post_data\")\r\n    return decodeURI(data)\r\n}\r\n\r\n// 开始加载游戏\r\nfunction JYXStartGame() {\r\n    if (window.nativeApp == null || window.nativeApp.onPKLoading == null) {\r\n        return;\r\n    }\r\n    window.nativeApp.onPKLoading('{}');\r\n}\r\n\r\n// 游戏加载成功\r\nfunction JYXFinishLoading() {\r\n    if (window.nativeApp == null || window.nativeApp.onPKFinishLoading == null) {\r\n        return;\r\n    }\r\n    window.nativeApp.onPKFinishLoading('{}');\r\n}\r\n\r\n// 游戏加载失败\r\nfunction JYXLoadFail() {\r\n    if (window.nativeApp == null || window.nativeApp.onPKLoadFail == null) {\r\n        return;\r\n    }\r\n    window.nativeApp.onPKLoadFail('{}');\r\n}\r\n\r\n// 游戏开始\r\nfunction JYXPKStart() {\r\n    if (window.nativeApp == null || window.nativeApp.onPKStart == null) {\r\n        return;\r\n    }\r\n    window.nativeApp.onPKStart('{}');\r\n}\r\n\r\n// 游戏结束\r\nfunction JYXPKFinish(result) {\r\n    if (window.nativeApp != null && window.nativeApp.onPKFinish != null) {\r\n        window.nativeApp.onPKFinish(result);\r\n        return;\r\n    }\r\n\r\n    try {\r\n        TZOpen.getResult(result);\r\n    } catch (e) {\r\n    }\r\n}\r\n\r\nfunction JYXInfo(str) {\r\n    if (window.nativeApp == null) {\r\n        return;\r\n    }\r\n    window.nativeApp.logInfo(str);\r\n}\r\n\r\nfunction JYXError(str) {\r\n    if (window.nativeApp == null) {\r\n        return;\r\n    }\r\n    window.nativeApp.logError(str)\r\n}\r\n\r\nvar YYSDK = {\r\n    GetWsUrl: GetWsUrl,\r\n    GetWssUrl: GetWssUrl,\r\n    JYXStartGame: JYXStartGame,\r\n    JYXFinishLoading: JYXFinishLoading,\r\n    JYXLoadFail: JYXLoadFail,\r\n    JYXPKStart: JYXPKStart,\r\n    JYXPKFinish: JYXPKFinish,\r\n    JYXInfo: JYXInfo,\r\n    JYXError: JYXError,\r\n    getSignData: function () {\r\n        var timestamp = GetQueryString(\"timestamp\");\r\n        var nonstr = GetQueryString(\"nonstr\");\r\n        var sign = GetQueryString(\"sign\");\r\n        var post_data = GetQueryString(\"post_data\");\r\n        if (timestamp && nonstr && sign && post_data) {\r\n            return {\r\n                timestamp: timestamp,\r\n                nonstr: nonstr,\r\n                sign: sign,\r\n                post_data: post_data,\r\n            }\r\n        }\r\n        return null;\r\n    },\r\n    getGameData: function () {\r\n        var userdata = JYXGetGameData();\r\n        if (userdata) {\r\n            try {\r\n                userdata = JSON.parse(userdata);\r\n                return userdata;\r\n            } catch (e) {\r\n                return null;\r\n            }\r\n        }\r\n        return null;\r\n    },\r\n    getRoomId: function () {\r\n        var userdata = this.getGameData();\r\n        if (userdata) {\r\n            return userdata.roomid;\r\n        }\r\n        return 0;\r\n    },\r\n    getPlayer: function () {\r\n        var userdata = this.getGameData();\r\n        if (userdata) {\r\n            return userdata.player;\r\n        }\r\n        return null;\r\n    }\r\n}\r\nexports.YYSDK = YYSDK;"]}